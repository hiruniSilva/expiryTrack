let express,config,models;_eaf‍.x([["default",()=>_eaf‍.o]]);_eaf‍.w("express",[["default",["express"],function(v){express=v}]]);_eaf‍.w("../config",[["default",["config"],function(v){config=v}]]);_eaf‍.w("../models",[["default",["models"],function(v){models=v}]]);



const router = express.Router();

router.post("/login", async (req, res) => {
	try {
		const { email, password } = req.body;

		const user = await models.User.findOne({ where: { email } });
		if (!user) throw new Error("Incorrect Email or Password");
		const validPassword = await user.comparePassword(password);
		if (!validPassword) throw new Error("Incorrect Email or Password");
		const tokens = user.generateTokens()
		res.cookie('token', tokens.accessToken)
		res.status(200).json({
			tokens: tokens,
			user: user.toUserJson(),
		});
	} catch (error) {
		res.status(400).send(error.message);
	}
});
_eaf‍.d(router);